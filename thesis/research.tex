\section{Classifying and parameterizing elements of different geometric interpretations}
\label{ch:research}

Before an implementation of a visualization can be made for a model, the geometric aspects of the elements of the model must be investigated.  A full inventory of the geometric elements has been done~\cite[Chapter 3]{Pottmann}, but in different terms.  Those terms are traditional, but do not hint at the geometric concept.  Besides the traditional terms, geometric inspired terms will be used.  

The following sections will discuss the geometrically different blades of a certain grade, together with their duals.  The discussion of $(n>1)$-blades is limited to those composed of null vectors.  
%Besides text, each part has an accompanying table that contains the following information on the discussed blades:\note{\LeosReply{Als deze dingen van mijn 'internal report' komen moet je dat vermelden, als je ze zelf aanvult is het 'partially based on'.}
%
%\myReply{Hoe verwijs ik naar dit artikel?}}
%\begin{itemize}
%  \item \texttt{g}: the grade of the blade.
%  \item $B^2$: the square of the blade.  The relation of this scalar value to zero is indicated in the table with $> 0$, $= 0$, $< 0$ and $\not= 0$.
%  \item Form: the general formula.  A blade factor can be either a line or screw axis, denoted by $\pline$ and $\screw$.  In certain cases, the difference between a real and ideal line is made with $\rline$ and $\iline$.  Here it does not concern any algebraic difference.  The difference is based on the visualization.  In other cases, a small textual note is given to indicate that the factors coincide at a single point (``pt.\ int.'') or in a plane (``pl.\ int.''), intersect each other pairwise (``pw.\ int''), or no factors intersect at all (``skew'').
%  \item Visualization: the picture of a typical blade of this type.
%  \item Name: what the blade class is named.  Traditional names, if needed, have been referenced.  In case of non-geometrically inspired terms, a more geometric alternative is given.  These are marked with ``\newterm''.
%    
%    \myReply{Leo: Deze namen gebruik ik alleen in de tabel, of meer beschrijvend (``the blade of two skew lines'').  Is het wel gepast om nieuwe namen te introduceren zonder al te veel motivatie, of is dit al genoeg motivatie?}
%\end{itemize}


\TODO{Add pictures!}

\subsection{Blades of grade 0 and 6}
%\begin{table}
%  \caption{An inventory of the blades of grade 0 and 6.}
%  \label{tab:inv0}
%  \begin{center}
%    \begin{tabular}{|c|r|l|c|l|}
%      \hline
%      \multicolumn{1}{|c|}{\texttt{g}} & $B^2$ & \multicolumn{1}{|c|}{Form} & \multicolumn{1}{|c|}{Visualization} & \multicolumn{1}{|c|}{Name} \\ \hline
%      \hline
%      0 & $\in \reals$ & $1 = \dual{\ppseudo}$ & & Scalar~\cite{TheBook} \\ \hline
%      6 & $\in \reals$ & $\ppseudo = \dual{1}$ & & Pseudoscalar~\cite{TheBook} \\ \hline
%    \end{tabular}
%  \end{center}
%\end{table}

Scalars and pseudoscalars are interpreted the same as in other models for geometric algebra.  Scalars can be used to represent weights.  Its dual, the pseudoscalar, may be utilized to denote the subspace volume.

\subsection{Blades of grade 1 and 5}
%\begin{table}
%  \caption{An inventory of the blades of grade 1 and 5.}
%  \label{tab:inv1}
%  \begin{center}
%    \begin{tabular}{|c|r|p{2.7cm}|p{2cm}|p{5cm}|}
%      \hline
%      \multicolumn{1}{|c|}{\texttt{g}} & $B^2$ & \multicolumn{1}{|c|}{Form} & \multicolumn{1}{|c|}{Visualization} & \multicolumn{1}{|c|}{Name} \\ \hline
%      \hline
%      1 & $= 0$ & $\rline$ & & Real line, path normal for uniform rotating motion~\cite{Pottmann}\\ \hline
%      1 & $= 0$ & $\iline$ & & Ideal line, path normal for uniform translating motion~\cite{Pottmann}\\ \hline
%      1 & $\not= 0$ & $\screw$ & & Axis of a screw motion~\cite{Pottmann}\\ \hline
%      5 & $= 0$ & $\dual{\rline}$ & & Singular linear complex~\cite{Pottmann}, uniform rotating motion \\ \hline
%      5 & $= 0$ & $\dual{\iline}$ & & Singular linear complex~\cite{Pottmann}, uniform translating motion \\ \hline
%      5 & $\not= 0$ & $\dual{\screw}$ & & Regular linear complex~\cite{Pottmann}, screw motion \\ \hline
%    \end{tabular}
%  \end{center}
%\end{table}
Although all vectors are projectively equivalent, we will distinguish three geometric classes.  For all three classes, their direction and moment are algebraically the same; these components are only interpreted differently in the domain of geometric interpretation.  The weight is computed as well in a uniform way, again through the homogeneous model:
\begin{equation*}
  \weight(x) = 
      \weight(\Em(x)) = \sqrt{(\Em(x) \lcont -\ez)^2 + (\dual{\Em(x)})^2} 
\end{equation*}
For non-null vectors, the weight can also be computed as $\sqrt{x \dotp x}$.  In the general case of a $k$-blade $x_1 \wedge \cdots \wedge x_k$, we define its weight as 

\begin{equation*}
  \weight(x_1 \wedge \cdots \wedge x_k) = \weight(\Em(x_1)) \cdots \weight(\Em(x_k)) .
\end{equation*}

It is clear from \autoref{sec:plucker} that the null vectors of the Pl\"ucker model (those vectors $v$ satisfying the Pl\"ucker identity $\pluckerid(v) = 0$) are interpreted as lines.  Let $l = d_1 \eze + d_2 \ezt + d_3 \ezd + m_1 \etd + m_2 \ede + m_3 \eet$ be a null vector.  The line can be interpreted through the homogeneous model.  The direction of the line corresponds to $(\Em(l) \lcont -\ez) / \weight(l)$, while its moment is $\dual{(\Em(l) \wedge \ez)} / \weight(l) = (\Em(l) \lcont (\ez \lcont \inverse{(\hpseudo)})) / \weight(l) = (\edual{\Em(l)}) / \weight(l)$.  

A special case are the ideal lines.  The homogeneous model allows two interpretations.  Its first, and most common interpretation is a 2D direction, the same interpretation as it is given in the Euclidean model.  For the second interpretation, we have to look a bit closer at the homogeneous model.  A homogeneous line can be defined as the outer product of two homogeneous points.  A homogeneous point $a = \V{a} + \alpha \ez$ has location $\V{a} / (\ez \dotp a)$.  In the case of ideal lines, we are dealing with points of the form $a = \lim_{\alpha \to 0} \V{a} + \alpha \ez$.  Its location then becomes $\lim_{\alpha \to 0} \V{a} / (\ez \dotp a) = \infty$.  Because $\V{a}$ is not depending on $\lim_{\alpha \to 0} \ez \dotp a$, the model allows more than one point on that location, each with a different direction.\footnote{A similar definition found in other sources~\cite[Section 11.3]{TheBook} is $a = \lim_{\norm{\V{a}} \to \infty}$.  This avoids division by zero, but is less appropriate in our case.}  Lines of two of these points at infinity are at infinity as well.  One can visualize such an ideal line $\l_\infty = m_1 \etd + m_2 \ede + m_3 \eet$ as a horizon, a circle on the celestial sphere in direction $\dual{(Em(l_\infty) \wedge \ez)} / \weight(l)$.  We will use this last interpretation as the default interpretation.  When the 2D direction interpretation is used, it will be explicitly stated.

The vectors that do not square to $0$ can be interpreted as the axis of a helical, or screw motion~\cite[Section 3.1.2]{Pottmann}.  A screw motion simultaneously translates and rotates an object.  The object is translated along the same line as around which the rotation is performed.  The motion can be fully characterized by this line $a$ and the pitch $p$, the amount of translation per rotation.  For the grade 5 screw motion $S = \dual{\plucker{\V{d}}{\V{m}}}$, its pitch and axis are given by~\cite[Theorem 3.1.9]{Pottmann}:
\begin{align}
  \label{eq:screwparams}
  p &= \V{d} \dotp \V{m} / \V{d}^2 \nonumber \\
  a &= \plucker{\V{d}}{\V{m} - p \V{d}} .
\end{align}

From this, one can deduce what kind of objects the dual elements of real and ideal lines represent.  For an ideal line $l_\infty$ with $p = \lim_{\V{d} \to 0} \V{d} \dotp \V{m} / \V{d}^2 = \infty$ and $a = \lim_{\V{d} \to 0, p \to \infty} \plucker{\V{d}}{\V{m} - p \V{d}} = l_\infty$, we see that it is a pure translation.  Given a real line $l_o$, its pitch is $p = 0 / \V{d}^2 = 0$, because of the Pl\"ucker identity, seen in \autoref{eq:laplucker0}.  Its axis is $a = \plucker{\V{d}}{\V{m} - 0} = l_o$.  No matter how much of the rotation is applied, no translation will occur.  This shows that the dual of real lines represent pure rotational motions.
%
%A list of these elements is presented as a summary in \autoref{tab:inv1}. 


\subsection{Blades of grade 2 and 4}
%\begin{table}
%  \caption{An inventory of the blades of grade 2 and 4.}
%  \label{tab:inv2}
%  \begin{center}
%    \begin{tabular}{|c|r|p{2.7cm}|p{2cm}|p{5cm}|}
%      \hline
%      \multicolumn{1}{|c|}{\texttt{g}} & $B^2$ & \multicolumn{1}{|c|}{Form} & \multicolumn{1}{|c|}{Visualization} & \multicolumn{1}{|c|}{Name} \\ \hline
%      \hline
%      2 & $= 0$ & $\pline \wedge \pline$, pt.\ int. & & Pencil of linear line complexes~\cite{Pottmann}, pencil of lines~\cite{Hongbo} \\ \hline
%      2 & $> 0$ & $\pline \wedge \pline$, skew & & Hyperbolic pencil of linear complexes~\cite{Pottmann}, skew line pair~\newterm \\ \hline
%      2 & $\not= 0$ & $\pline \wedge \screw$ & \comment{HIDE THIS ROW} & Parabolic pencil of linear complexes~\cite{Pottmann} \\ \hline
%      2 & $< 0$ & $\screw \wedge \screw$ & \comment{HIDE THIS ROW} & Elliptic pencil of linear complexes~\cite{Pottmann} \\ \hline
%      4 & $= 0$ & $\dual{\left( \pline \wedge \pline \right)}$ & & Pencil of singular linear complexes~\cite{Pottmann}, dual pencil of lines \\ \hline
%      4 & $> 0$ & $\dual{\left( \pline \wedge \pline \right)}$, skew & & Hyperbolic linear congruence~\cite{Pottmann}, dual skew line pair~\newterm \\ \hline
%      4 & $\not= 0$ & $\dual{\left( \pline \wedge \screw \right)}$ & \comment{HIDE THIS ROW} & Parabolic linear congruence~\cite{Pottmann} \\ \hline
%      4 & $< 0$ & $\dual{\left( \screw \wedge \screw \right)}$ & \comment{HIDE THIS ROW} & Elliptic linear congruence~\cite{Pottmann}, pencil of reguli~\newterm \\ \hline
%    \end{tabular}
%  \end{center}
%\end{table}
%
A 2-blade $B = a \wedge b$ represents the set of linear combinations of $a$ and $b$:
\begin{equation*}
  \s{C} = \left\{ c \mid c \wedge B = 0 \right\} = \left\{ \lambda a + \mu b \mid \lambda, \mu \in \reals \right\} .
\end{equation*}
For the geometric interpretation of these blades, clarity on what kind of objects are in this set is needed.  On first inspection, this can be split in three cases, based on the number of null vectors among the factors.  We will limit this discussion to the case where both $a$ and $b$ are null vectors.

A linear combination $c = \lambda a + \mu b$ is a null vector if:
\begin{align}
  \label{eq:lincombnull}
  c^2 &= (\lambda a + \mu b) \dotp (\lambda a + \mu b) \nonumber \\
  &= \lambda^2 a^2 + 2 \lambda \mu a \dotp b + \mu^2 b^2 \nonumber \\
  &= 2 \lambda \mu a \dotp b
\end{align}

When $a$ and $b$ are coplanar, their inner product is zero (see \autoref{eq:coplanar}), and each linear combination $c = \lambda a + \mu b$ is a null vector.  This kind of object is called a pencil of linear line complexes~\cite[Section 3.2.1]{Pottmann}, or, a bit shorter, a pencil of lines~\cite{Hongbo}.

The homogeneous point in which all lines intersect, is called its center~\cite{Hongbo}, and can be computed, as seen in \autoref{eq:intersect}.  The bivector direction containing the pencil can be computed by:

\begin{align*}
  \V{D} &= \left(\Em(a) \lcont \ez \right) \wedge \left(\Em(b) \lcont \ez\right) \\
  &= \V{d}_a \wedge \V{d}_b 
\end{align*}

This has no practical results when $a$ and $b$ are parallel.  When they are parallel, $\Em(a) \lcont \ez$ differs from $\Em(b) \lcont \ez$ only in a scalar factor, and therefore their outer product is $0$.  The intersection of $a$ and $b$ happens at a point at infinity.  For visualizations, it proves useful to know the pencil's bivector direction, as well as a finite point on the pencil.  

As discussed, the intersection of two parallel lines results in a Euclidean vector, which can be interpreted as either a point at infinity in the homogeneous model, or a direction in the Euclidean model.  We can define the bivector direction of a pencil of parallel lines as:

\begin{equation*}
  \V{D} = \left(\Em(a) \cap \Em(b)\right) \wedge \left(p_b - p_a\right)
\end{equation*}

Often one takes the point on the object closest to the chosen origin.  For a line $l = \plucker{\V{d}}{\V{m}}$, this is given by $p = \V{m} \times \V{d} + \V{d}^2 \ez$~\cite{Shoemake}.  Let $p_a$ and $p_b$ be such points for $a$ and $b$.  The homogeneous line $C = p_a \wedge p_b$ is the line that intersects each line in their point closest to the origin.  We define a third point $p_C$ that is the point nearest the origin and on $C$.  This point lies on line $C$, as well as on a line contained by $B$, as $C$ contains the point nearest the origin of each line in $B$.

The dual of a pencil of lines contains the same set of lines~\cite[Section 3.2.1]{Pottmann}.  This can be easily shown.  Stating the definition of $\s{C}$ differently, we are looking for all lines that intersect with $B$.\note{\LeosReply{Wat bedoel je met intersect?
Als je bedoelt 'coincide'dan is dan de wedge-test.
Als je bedoelt: staan loodrecht op, dan is het de contraction test.}

\myReply{Dat weet ik nu niet eens zo zeker.  Het lijkt mij dat de contraction test hier ook ``snijdt elkaar in een (ideaal) punt'' betekent?}}  This is expressed as $c \wedge B = 0$.  For the grade-4 object $\dual{B}$, this can be written as $c \lcont \dual{B} = c \lcont (B \lcont \inverse{\ppseudo}) = (c \wedge B) \lcont \inverse{\ppseudo}$, with $\ppseudo$ the pseudoscalar of the space $\reals^{3,3}$.  This is only true for $c \wedge B = 0$, a test for containment of $c$ in $B$.

\askLeo{Above does not make complete sense, does it?  If true, this should mean that $\dual{\eze}$ represents the same object as $\eze$; a line and not a scala of reguli.}

Now look at the case where $a$ and $b$ are not coplanar, but $a \wedge b$ still contains lines.  \autoref{eq:lincombnull} shows that either $\lambda = 0$ or $\mu = 0$, as $a \dotp b \not= 0$ per definition.  This means that all null vectors in $\s{C}$ must be homogeneously equivalent to $a$ or $b$.  This class of geometric objects is known as the hyperbolic pencil of linear complexes.  Its dual, the hyperbolic linear congruence, contains all lines intersecting both $a$ and $b$~\cite[Proposition 3.2.3]{Pottmann}. That is, for each point $p_a$ on $a$ and $p_b$ on $b$, the line $c$ with embedding $\Em(c) = p_a \wedge p_b$ is in $\dual{B}$.  

Now that we have handled the cases where $a$ and $b$ are both null-vectors, we will investigate the case where .

\subsection{Blades of grade 3}
%\begin{table}
%  \caption{An inventory of the blades of grade 3.}
%  \label{tab:inv3}
%  \begin{center}
%    \begin{tabular}{|c|r|p{2.7cm}|p{2cm}|p{5cm}|}
%      \hline
%      \multicolumn{1}{|c|}{\texttt{g}} & $B^2$ & \multicolumn{1}{|c|}{Form} & \multicolumn{1}{|c|}{Visualization} & \multicolumn{1}{|c|}{Name} \\ \hline
%      \hline
%      3 & $= 0$ & $\pline \wedge \pline \wedge \pline$, pt.\ int. & & Bundle of lines, point~\newterm \\ \hline
%      3 & $\not= 0$ & $\pline \wedge \pline \wedge \pline$, pl.\ int. & & Field of lines, plane~\newterm \\ \hline
%      3 & $\not= 0$ & $\pline \wedge \pline \wedge \pline$, skew & & Regulus~\cite{Hongbo} \\ \hline
%      3 & $\not= 0$ & $\pline \wedge \pline \wedge \pline$, pw.\ int. & & Couple-wheel pencil~\cite{Hongbo}, line pencil pair~\newterm \\ \hline
%    \end{tabular}
%  \end{center}
%\end{table}
%
When talking about three lines $a, b, c$ in 3D space, we can distinguish several cases:

\begin{enumerate}[{Case} 1.]
  \item All lines are pairwise coplanar and intersect in a single point.  This is called a 2D concurrent pencil or point~\cite{Hongbo}.
  \item All lines are pairwise coplanar but intersect in three different points.  Li and Zhang name this object a 2D coplanar pencil, or plane~\cite{Hongbo}.
  \item One line is coplanar to the other two lines, which are not coplanar to each other.  This is a couple-wheel pencil~\cite{Hongbo}.
  \item No line is coplanar to the other lines.  The geometric entity is named a regulus~\cite[Section 3.3]{Pottmann}.
\end{enumerate}

Unlike blades of other grades, the dual of a 3-blade $B = a \wedge b \wedge c$ is $-B$; when dualized, only the orientation of the 3-blade is switched.  From here on, we will not give any attention to the duals of the 3-blades.

We will only discuss the first three geometric cases.  The last case defines the reguli, a class of hyperboloid and paraboloid ruled surfaces.  We do not treat them here, because of time constraints on the project and expected involved computations of the set of contained lines.  Let $x$ be the axis around which the lines of the regulus $R$ are placed, $p$ a plane perpendicular to $x$, $p_x$ the point where $x$ intersects $p$, and $\s{P}_R$ the set of intersection points of $p$ with the lines in $R$.  We expect that the Euclidean distance between $p_x$ and $p_R \in \s{P}_R$ is not constant for all points in $\s{P}_R$.  That is, for a general regulus $R$, we expect that $\s{P}_R$ describes an ellips.  For this we need to analyze the reguli better, which did not fit in the scope of this project.

Similar to the 2-blades, a 3-blade $B = a \wedge b \wedge c$ represents the set of linear combinations of $a$, $b$ and $c$:
\begin{equation*}
  \s{D} = \left\{d \mid d \wedge B = 0 \right\} = \left\{ \lambda a + \mu b + \nu c \mid \lambda, \mu, \nu \in \reals \right\} .
\end{equation*}
A linear combination $d = \lambda a + \mu b + \nu c$ is a null vector if:
\begin{align*}
  d^2 &= (\lambda a + \mu b + \nu c) \dotp (\lambda a + \mu b + \nu c) \\
  &= (\lambda a + \mu b) \dotp (\lambda a + \mu b) + (\lambda a + \mu b) \dotp \nu c + \nu c \dotp (\lambda a + \mu b) + \nu c \dotp \nu c \\
  &= 2 (\lambda \mu a \dotp b + (\lambda a + \mu b) \dotp \nu c) \\
  &= 2 (\lambda \mu a \dotp b + \lambda \nu a \dotp c + \mu \nu b \dotp c) .
\end{align*}

For the first two cases we have $a \dotp b = a \dotp c = b \dotp c = 0$, and thus all linear combinations of $a$, $b$ and $c$ are in $\s{D}$.  Their points of intersecting are given by $p_{ab} = \Em(a) \cap \Em(b)$, $p_{bc} = \Em(b) \cap \Em(c)$, $p_{ca} = \Em(c) \cap \Em(a)$.  Projectively, cases 1.\ and 2.\ are equivalent (the point of intersection is not a projective property, but coplanarity is), but their geometric interpretation differs.

The case of three lines intersecting in a single point can be seen as a 3D pencil of lines.  Given a pencil of lines $a \wedge b$, we take the outer product with a third line $c$ that goes through the center of the pencil.  This bundle of lines can be used to represent a point, as it is rotation-invariant.  We have already computed the location of this point; it is the same as the center of $a \wedge b$, as $p_{ab} = p_{bc} = p_{ca}$ per definition.

When three lines are parallel to each other, their meet results in a Euclidean vector.  Just like ideal lines, these elements can be interpreted in two ways.  One way is to look at it as a direction, similar to the Euclidean interpretation.  The homogeneous model gives us the interpretation of a point infinitely far away.  This interpretation is an extension of the notion of a point.  Let $a = \lim_{\alpha \to 0} \V{a} + \alpha \ez$ be a point in the homogeneous model.  Its location is computed by $\lim_{\alpha \to 0} a / (\ez \dotp a) = \infty$~\cite[Section 11.2]{TheBook}.  Both interpretations are correct, however incomplete.  In our interpretation, lines do not only intersect at $a$ on the celestial sphere, but also in $-a$.  Because all elements extend infinitely, they intersect the celestial sphere twice.  This point pair-like characteristic can also be observed when defining ideal points on the celestial sphere.  There we can define an ideal point as the intersection of two horizons.  When visualized, it becomes clear that the horizons intersect twice.

The second case states that $a$, $b$ and $c$ intersect each other in three different points.  Again, any linear combination of $a$, $b$ and $c$ is contained by $\s{D}$, but this represents a plane; $\s{D}$ contains all lines in direction $\V{D} = \frac{1}{3} \V{d}_a \wedge \V{d}_b + \V{d}_b \wedge \V{d}_c + \V{d}_c \wedge \V{d}_a$.  Because $p_{ab}$, $p_{bc}$ and $p_{ca}$ lie in the same plane, we compute the location of $B$ in the same way as it is computed for $p_{ab} \wedge p_{bc} \wedge p_{ca}$.

The outer product of the three ideal lines span an ideal plane.  In our celestial sphere interpretation, they represent the sphere itself.  In the interpretation of the Euclidean directions, as well as the homogeneous model, it corresponds with the Euclidean pseudoscalar.

The third case describes a pair of line pencils, joined through a single common line.  Let $b$ be the connecting line of the two pencils: $a \dotp b = b \dotp c = 0$ and $a \dotp c \not= 0$. The null vectors of $\s{D}$ are exactly those contained by the set of linear combinations of $a \wedge b$ and $b \wedge c$.

Because $b$ intersects both $a$ and $c$, we can rewrite $d^2 = 0$ as $\lambda \nu a \dotp c = 0$.  This only holds for $\lambda = 0$ or $\nu = 0$.  $\s{D}$ corresponds with the union of sets of lines $\s{L}_{ab}$, $\s{L}_{bc}$, $\s{L}_{ca}$ for respectively $a \wedge b$, $b \wedge c$ and $c \wedge a$:
\begin{align*}
  \s{L}_{ab} \cup \s{L}_{bc} \cup \s{L}_{ca} &= \left\{ \lambda a + \mu b \right\} \cup \left\{ \mu b + \nu c \right\} \cup \left\{ \nu c + \lambda a \mid \nu = 0 \vee \lambda = 0 \right\} \\
  &= \left\{ \lambda a + \mu b \right\} \cup \left\{ \mu b + \nu c \right\} \\
  &= \left\{ \lambda a + \mu b + \nu c \mid \nu = 0 \right\} \cup \left\{ \lambda a + \mu b + \nu c \mid \lambda = 0 \right\} \\
  &= \left\{ \lambda a + \mu b + \nu c \right\} \\
  &= \s{D} ,
\end{align*}
with $\lambda, \mu, \nu \in \reals$.
